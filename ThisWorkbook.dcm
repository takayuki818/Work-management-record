VERSION 1.0 CLASS
BEGIN
  MultiUse = -1  'True
END
Attribute VB_Name = "ThisWorkbook"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Option Explicit
Private Sub Workbook_SheetDeactivate(ByVal Sh As Object)
    If Sh.Name = "個別シフト表" Then
        With Sheets("個別シフト表")
            Select Case 編集差分確認()
                Case "未登録"
                    Select Case MsgBox("台帳登録が実行されていません" & vbCrLf & vbCrLf & "編集内容をクリアしてよろしいですか？", vbYesNo)
                        Case vbYes
                            Call 個別シフト表クリア
                            Application.EnableEvents = False
                            Sheets("個別シフト表").Range("例月区分").MergeArea.ClearContents
                            Sheets("個別シフト表").Range("氏名").MergeArea.ClearContents
                            Application.EnableEvents = True
                        Case vbNo: Sh.Activate
                    End Select
                Case "差分あり"
                    Select Case MsgBox("台帳更新が実行されていません" & vbCrLf & vbCrLf & "編集内容をクリアしてよろしいですか？", vbYesNo)
                        Case vbYes: Call 記録戻し
                        Case vbNo: Sh.Activate
                    End Select
            End Select
        End With
    End If
End Sub

